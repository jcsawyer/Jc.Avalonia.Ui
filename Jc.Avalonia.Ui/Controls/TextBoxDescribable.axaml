<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    x:CompileBindings="True">
  <Design.PreviewWith>
    <Border Padding="50">
      <StackPanel Spacing="5">
        <TextBox />
        <TextBox Text="Hello Down there"/>
        <TextBox Watermark="Watermark" />
        <TextBox Text="Test" IsEnabled="False" />
        <TextBox Text="Test Clear" Classes="clearButton" />
        <TextBox Text="Test Password" Classes="revealPasswordButton" PasswordChar="&#x25CF;" />
        <TextBox Watermark="Search for a food...">
          <TextBox.InnerLeftContent>
            <Border Padding="5 0">
              <PathIcon Data="{StaticResource search}" Height="12" Width="12" Foreground="#459dd5" />
            </Border>
          </TextBox.InnerLeftContent>
        </TextBox>
      </StackPanel>
    </Border>
  </Design.PreviewWith>
  
  <ControlTheme x:Key="{x:Type TextBoxDescribable}"
                TargetType="TextBoxDescribable">
    <Setter Property="CaretBrush" Value="{DynamicResource ThemeForegroundBrush}" />
    <Setter Property="Background" Value="#f3f3f3" />
    <Setter Property="FontSize" Value="14"></Setter>
    <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderMidBrush}" />
    <Setter Property="CornerRadius" Value="10"></Setter>
    <Setter Property="Foreground" Value="{DynamicResource ThemeForegroundBrush}" />
    <Setter Property="BorderThickness" Value="{DynamicResource ThemeBorderThickness}" />
    <Setter Property="SelectionBrush" Value="{DynamicResource HighlightBrush}" />
    <Setter Property="SelectionForegroundBrush" Value="{DynamicResource HighlightForegroundBrush}" />
    <Setter Property="Padding" Value="15 10" />
    <Setter Property="ContextFlyout" Value="{StaticResource SimpleTextBoxContextFlyout}" />
    <Setter Property="ScrollViewer.IsScrollChainingEnabled" Value="True" />
    <Setter Property="VerticalContentAlignment" Value="Center"></Setter>
    <Setter Property="Template">
      <ControlTemplate>
        <Border Name="border"
                Padding="10"
                Margin="10"
                CornerRadius="10"
                Background="{DynamicResource ListBoxItemBackground}">
          <DockPanel HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                     VerticalAlignment="{TemplateBinding VerticalContentAlignment}">

            <TextBlock Name="floatingWatermark"
                       DockPanel.Dock="Top"
                       FontSize="{DynamicResource FontSizeSmall}"
                       Foreground="{DynamicResource ThemeAccentBrush}"
                       Text="{TemplateBinding Watermark}">
              <TextBlock.IsVisible>
                <MultiBinding Converter="{x:Static BoolConverters.And}">
                  <Binding Path="UseFloatingWatermark"
                           RelativeSource="{RelativeSource TemplatedParent}" />
                  <Binding Converter="{x:Static StringConverters.IsNotNullOrEmpty}"
                           Path="Text"
                           RelativeSource="{RelativeSource TemplatedParent}" />
                </MultiBinding>
              </TextBlock.IsVisible>
            </TextBlock>
            
            <TextBlock
              DockPanel.Dock="Bottom"
              Text="{TemplateBinding Label}"
              Foreground="#a2a2a2"
              IsVisible="{TemplateBinding Label}"
              FontSize="12"
              Margin="0 5 0 0" />

            <DataValidationErrors>

              <Grid ColumnDefinitions="Auto,*,Auto">
                <ContentPresenter Grid.Column="0"
                                  Grid.ColumnSpan="1"
                                  Content="{TemplateBinding InnerLeftContent}" />
                <ScrollViewer Name="PART_ScrollViewer"
                              Grid.Column="1"
                              Grid.ColumnSpan="1"
                              AllowAutoHide="{TemplateBinding (ScrollViewer.AllowAutoHide)}"
                              BringIntoViewOnFocusChange="{TemplateBinding (ScrollViewer.BringIntoViewOnFocusChange)}"
                              HorizontalScrollBarVisibility="{TemplateBinding (ScrollViewer.HorizontalScrollBarVisibility)}"
                              IsScrollChainingEnabled="{TemplateBinding (ScrollViewer.IsScrollChainingEnabled)}"
                              VerticalScrollBarVisibility="{TemplateBinding (ScrollViewer.VerticalScrollBarVisibility)}">
                  <Panel>
                    <TextBlock Name="watermark"
                               HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                               VerticalAlignment="{TemplateBinding VerticalContentAlignment}"   
                               Opacity="0.5"
                               Text="{TemplateBinding Watermark}"
                               TextAlignment="{TemplateBinding TextAlignment}"
                               TextWrapping="{TemplateBinding TextWrapping}">
                      <TextBlock.IsVisible>
                        <MultiBinding Converter="{x:Static BoolConverters.And}">
                          <Binding ElementName="PART_TextPresenter" Path="PreeditText" Converter="{x:Static StringConverters.IsNullOrEmpty}"/>
                          <Binding RelativeSource="{RelativeSource TemplatedParent}" Path="Text" Converter="{x:Static StringConverters.IsNullOrEmpty}"/>
                        </MultiBinding>
                      </TextBlock.IsVisible>
                    </TextBlock>
                    <TextPresenter Name="PART_TextPresenter"
                                   CaretBlinkInterval="{TemplateBinding CaretBlinkInterval}"
                                   CaretBrush="{TemplateBinding CaretBrush}"
                                   CaretIndex="{TemplateBinding CaretIndex}"
                                   LineHeight="{TemplateBinding LineHeight}"
                                   LetterSpacing="{TemplateBinding LetterSpacing}"
                                   PasswordChar="{TemplateBinding PasswordChar}"
                                   RevealPassword="{TemplateBinding RevealPassword}"
                                   SelectionBrush="{TemplateBinding SelectionBrush}"
                                   SelectionEnd="{TemplateBinding SelectionEnd}"
                                   SelectionForegroundBrush="{TemplateBinding SelectionForegroundBrush}"
                                   SelectionStart="{TemplateBinding SelectionStart}"
                                   Text="{TemplateBinding Text,Mode=TwoWay}"
                                   TextAlignment="{TemplateBinding TextAlignment}"
                                   TextWrapping="{TemplateBinding TextWrapping}"
                                   VerticalAlignment="{TemplateBinding VerticalContentAlignment}"   />
                  </Panel>
                  <ScrollViewer.Styles>
                    <Style Selector="ScrollContentPresenter#PART_ContentPresenter">
                      <Setter Property="Cursor" Value="IBeam" />
                    </Style>
                  </ScrollViewer.Styles>
                </ScrollViewer>
                <ContentPresenter Grid.Column="2"
                                  Grid.ColumnSpan="1"
                                  Content="{TemplateBinding InnerRightContent}" />
              </Grid>
            </DataValidationErrors>
          </DockPanel>
        </Border>
      </ControlTemplate>
    </Setter>

    <Style Selector="^:pointerover /template/ Border#border">
      <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderHighBrush}" />
    </Style>
    <Style Selector="^:focus /template/ Border#border">
      <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderHighBrush}" />
    </Style>
    <Style Selector="^:focus /template/ TextBlock#watermark">
      <Setter Property="Foreground" Value="Transparent" />
    </Style>
    <Style Selector="^:error /template/ Border#border">
      <Setter Property="BorderBrush" Value="{DynamicResource ErrorBrush}" />
    </Style>
    <Style Selector="^ /template/ DockPanel">
      <Setter Property="Cursor" Value="IBeam" />
    </Style>
    <Style Selector="^:disabled /template/ Border#border">
      <Setter Property="Opacity" Value="{DynamicResource ThemeDisabledOpacity}" />
    </Style>
    <Style Selector="^ /template/ TextBlock#floatingWatermark">
      <Setter Property="Cursor" Value="IBeam"/>
    </Style>

    <Style Selector="^.clearButton[AcceptsReturn=False][IsReadOnly=False]:focus:not(TextBox:empty)">
      <Setter Property="InnerRightContent">
        <Template>
          <Button Command="{Binding $parent[TextBox].Clear}"
                  Focusable="False"
                  Theme="{StaticResource SimpleTextBoxClearButtonTheme}" 
                  ClipToBounds="True" />
        </Template>
      </Setter>
    </Style>

    <Style Selector="^.revealPasswordButton[AcceptsReturn=False][IsReadOnly=False]:not(TextBox:empty)">
      <Setter Property="InnerRightContent">
        <Template>
          <Panel Margin="4,0">
            <Panel.Styles>
              <Style Selector="ToggleButton[IsChecked=True]">
                <Setter Property="(ToolTip.Tip)" Value="Hide Password" />
              </Style>
              <Style Selector="ToggleButton[IsChecked=False]">
                <Setter Property="(ToolTip.Tip)" Value="Show Password" />
              </Style>
            </Panel.Styles>
            <ToggleButton Background="Transparent"
                          Focusable="False"
                          IsChecked="{Binding $parent[TextBox].RevealPassword, Mode=TwoWay}"
                          Theme="{StaticResource SimplePasswordBoxRevealButtonTheme}"
                          ClipToBounds="True" />
          </Panel>
        </Template>
      </Setter>
    </Style>
  </ControlTheme>
</ResourceDictionary>